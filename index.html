<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Love Letter</title>
  <style>
    *{box-sizing:border-box;}
    :root{
      --env-w:420px;
      --env-h:280px;
      --flap-h:140px;
    }
    body{
      margin:0;
      font-family:serif;
      background:linear-gradient(135deg,#ffe6f0,#f5e6ff 60%,#e6f0ff);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:60px;
      padding:40px;
      overflow:hidden;
      position:relative;
    }

    .image-box{
      width:300px;
      height:300px;
      border-radius:18px;
      overflow:hidden;
      box-shadow:0 14px 40px rgba(0,0,0,.12);
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.02));
      position:relative;
    }
    .image-box img{ width:100%; height:100%; object-fit:cover; display:block; }

    /* phong b√¨ */
    .envelope{
      width:var(--env-w);
      height:var(--env-h);
      border-radius:18px;
      background:linear-gradient(135deg,#ff4d6d,#ff80a0);
      box-shadow:0 18px 40px rgba(0,0,0,.22);
      position:relative;
      cursor:pointer;
      overflow:hidden;
      transition:transform .3s ease;
      perspective:1000px;
    }
    .envelope:hover{ transform:translateY(-6px); }

    .inner-cover{
      position:absolute;
      inset:0;
      background:linear-gradient(135deg,#ff2a5a,#ff6a8c);
      z-index:5;
    }

    .flap{
      position:absolute; left:0; right:0; top:0;
      height:var(--flap-h);
      background:linear-gradient(135deg,#e63950,#ff4d6d);
      clip-path:polygon(0 0,100% 0,50% 100%);
      transform-origin:top;
      transition:transform 1s cubic-bezier(.2,.9,.2,1), opacity .5s;
      z-index:20;
      pointer-events:none;
    }
    .flap.open{
      transform:rotateX(180deg);
      opacity:.95;
      z-index:2;
    }

    .seal{
      position:absolute;
      top:calc(var(--flap-h) - 35px);
      left:50%;
      transform:translateX(-50%);
      width:86px;height:86px;
      border-radius:50%;
      background:white;color:#e22;
      display:flex;align-items:center;justify-content:center;
      font-size:40px;
      box-shadow:0 6px 18px rgba(0,0,0,.18);
      z-index:21;
      transition:opacity .4s;
    }

    .pocket{
      position:absolute;
      inset:0;
      overflow:hidden;
      pointer-events:none;
      z-index:10;
    }

    .letter{
      position:absolute;
      left:50%;
      top:10px;
      bottom:10px;
      width:80%;
      background:#fff;
      border-radius:12px;
      padding:18px;
      transform:translate(-50%,100%);
      opacity:0;
      box-shadow:0 14px 30px rgba(0,0,0,0.18);
      transition:transform 1s cubic-bezier(.2,.9,.2,1), opacity 1s;
      z-index:15;
      overflow-y:auto;
    }
    .letter.show{
      transform:translate(-50%,0);
      opacity:1;
    }

    .letter::-webkit-scrollbar{width:7px;}
    .letter::-webkit-scrollbar-thumb{
      background:linear-gradient(180deg,#ff7fa8,#ff4d6d);
      border-radius:6px;
    }

    .message{
      color:#d33;
      font-size:18px;
      line-height:1.7;
      text-align:center;
      margin:6px 0 40px;
    }

    /* 3 tr√°i tim n·ªÅn */
    .heart-group {
      position: fixed;
      bottom: 40px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 20px;
      z-index: 100;
    }
    .heart-group span {
      font-size: 42px;
      color: #ff1a3c;
      animation: pulse 2s ease-in-out infinite;
      filter: drop-shadow(0 0 8px rgba(255,80,100,0.4));
    }
    .heart-group span:nth-child(2) { animation-delay: 0.3s; }
    .heart-group span:nth-child(3) { animation-delay: 0.6s; }
    @keyframes pulse{
      0%,100%{transform:scale(1);opacity:.8;}
      50%{transform:scale(1.25);opacity:1;}
    }

    #musicBtn{
      position:fixed;
      right:20px; top:18px;
      width:56px; height:56px;
      border-radius:50%;
      display:flex;align-items:center;justify-content:center;
      background:rgba(255,255,255,.9);
      box-shadow:0 8px 24px rgba(0,0,0,.12);
      border:none; font-size:22px;
      cursor:pointer; z-index:2000;
    }

    .heart{
      position:absolute;
      color:rgba(255,0,0,.35);
      font-size:24px;
      animation:float 6s linear infinite;
    }
    @keyframes float{
      0%{transform:translateY(100vh);opacity:0}
      30%{opacity:1}
      100%{transform:translateY(-10vh);opacity:0}
    }

    @media(max-width:900px){
      body{flex-direction:column;gap:24px;padding:20px;}
      .image-box{width:240px;height:240px;}
      .envelope{width:360px;}
    }
  </style>
</head>
<body>
  <div class="image-box">
    <img src="cha.jpg" alt="·∫¢nh minh h·ªça">
  </div>

  <div class="envelope" id="envelope">
    <div class="inner-cover"></div>
    <div class="flap" id="flap"></div>
    <div class="seal" id="seal">‚ù§</div>

    <div class="pocket">
      <div class="letter" id="letter">
        <div id="messages">
          <p class="message">
            Anh y√™u em, c√¥ g√°i nh·ªè c·ªßa cu·ªôc ƒë·ªùi anh.  
            C·∫£m ∆°n em v√¨ ƒë√£ ƒë·∫øn v√† khi·∫øn cu·ªôc s·ªëng c·ªßa anh ·∫•m √°p h∆°n m·ªói ng√†y.  
            <br><br>
            M·ªói n·ª• c∆∞·ªùi c·ªßa em khi·∫øn anh mu·ªën c·ªë g·∫Øng.  
            D√π c√≥ chuy·ªán g√¨ x·∫£y ra, anh v·∫´n lu√¥n ·ªü ƒë√¢y, y√™u th∆∞∆°ng v√† che ch·ªü cho em.  
            <br><br>
            Em l√† ph√©p m√†u ƒë·∫πp nh·∫•t m√† cu·ªôc ƒë·ªùi n√†y ƒë√£ ban cho anh.  
            <br><br>
            - Ng∆∞·ªùi y√™u c·ªßa em -
          </p>
        </div>
      </div>
    </div>
  </div>

  <!-- 3 tr√°i tim n·ªÅn -->
  <div class="heart-group">
    <span>‚ù§</span>
    <span>‚ù§</span>
    <span>‚ù§</span>
  </div>

  <!-- N√∫t nh·∫°c -->
  <button id="musicBtn">üîà</button>

  <!-- File nh·∫°c c·ªßa b·∫°n -->
  <audio id="bgm" loop>
    <source src="mp3music.mp3" type="audio/mpeg">
    Tr√¨nh duy·ªát c·ªßa b·∫°n kh√¥ng h·ªó tr·ª£ ph√°t nh·∫°c.
  </audio>

  <script>
    document.addEventListener('DOMContentLoaded', ()=>{
      const flap = document.getElementById('flap');
      const seal = document.getElementById('seal');
      const letter = document.getElementById('letter');
      const bgm = document.getElementById('bgm');
      const musicBtn = document.getElementById('musicBtn');
      const envelope = document.getElementById('envelope');

      // Click phong b√¨
      envelope.addEventListener('click', ()=>{
        flap.classList.toggle('open');
        seal.style.opacity = flap.classList.contains('open') ? '0' : '1';
        if(flap.classList.contains('open')){
          setTimeout(()=>letter.classList.add('show'), 600);
          // Ph√°t nh·∫°c khi m·ªü phong b√¨
          bgm.play().then(()=> musicBtn.innerText='üîä')
            .catch(()=> console.log("Autoplay b·ªã ch·∫∑n, click ƒë·ªÉ b·∫≠t nh·∫°c."));
        }else{
          letter.classList.remove('show');
          bgm.pause();
          musicBtn.innerText='üîà';
        }
      });

      // N√∫t b·∫≠t/t·∫Øt nh·∫°c
      musicBtn.addEventListener('click', ()=>{
        if(bgm.paused){
          bgm.play().catch(()=>{});
          musicBtn.innerText='üîä';
        }else{
          bgm.pause();
          musicBtn.innerText='üîà';
        }
      });

      // Cho ph√©p ph√°t nh·∫°c sau click ƒë·∫ßu ti√™n
      document.addEventListener("click", ()=>{
        if (bgm.paused) {
          bgm.play().catch(()=>{});
          musicBtn.innerText='üîä';
        }
      }, { once:true });
    });
  </script>
</body>
</html>
